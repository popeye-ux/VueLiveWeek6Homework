(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a7b7a38a"],{"7f36":function(e,t,a){"use strict";var c=a("7a23"),n={"aria-label":"Page navigation example"},l={class:"pagination"},r=Object(c["createElementVNode"])("span",{"aria-hidden":"true"},"«",-1),o=[r],d={key:0,class:"page-link"},i=["onClick"],s=Object(c["createElementVNode"])("span",{"aria-hidden":"true"},"»",-1),b=[s];function p(e,t,a,r,s,p){return Object(c["openBlock"])(),Object(c["createElementBlock"])("nav",n,[Object(c["createElementVNode"])("ul",l,[Object(c["createElementVNode"])("li",{class:Object(c["normalizeClass"])(["page-item",{disabled:!a.pages.has_pre}])},[Object(c["createElementVNode"])("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=Object(c["withModifiers"])((function(t){return e.$emit("get-products",a.pages.current_page-1)}),["prevent"]))},o)],2),(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(a.pages.total_pages,(function(t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("li",{class:Object(c["normalizeClass"])(["page-item",{active:t===a.pages.current_page}]),key:t+"page"},[t===a.pages.current_page?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",d,Object(c["toDisplayString"])(t),1)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("a",{key:1,class:"page-link",href:"#",onClick:Object(c["withModifiers"])((function(a){return e.$emit("get-products",t)}),["prevent"])},Object(c["toDisplayString"])(t),9,i))],2)})),128)),Object(c["createElementVNode"])("li",{class:Object(c["normalizeClass"])(["page-item",{disabled:!a.pages.has_next}])},[Object(c["createElementVNode"])("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=Object(c["withModifiers"])((function(t){return e.$emit("get-products",a.pages.current_page+1)}),["prevent"]))},b)],2)])])}var m={props:["pages"],emits:["get-products"]},u=a("6b0d"),O=a.n(u);const j=O()(m,[["render",p]]);t["a"]=j},"80ac":function(e,t,a){"use strict";a.r(t);var c=a("7a23"),n={class:"container"},l=Object(c["createElementVNode"])("h2",{class:"text-center"},"這是訂單管理",-1),r={class:"text-end pt-5"},o=["disabled"],d={class:"table mt-4"},i=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"購買時間"),Object(c["createElementVNode"])("th",null,"Email"),Object(c["createElementVNode"])("th",null,"購買款項"),Object(c["createElementVNode"])("th",null,"應付金額"),Object(c["createElementVNode"])("th",null,"是否付款"),Object(c["createElementVNode"])("th",null,"編輯")])],-1),s={class:"table"},b={width:"100"},p={width:"50"},m={class:"text-right"},u={class:"form-check form-switch"},O=["id","onUpdate:modelValue","onChange"],j=["for"],h={key:0},E={key:1},g={class:"btn-group"},N=["onClick"],V=["onClick"];function f(e,t,a,f,k,y){var v=Object(c["resolveComponent"])("Loading"),D=Object(c["resolveComponent"])("pagination"),B=Object(c["resolveComponent"])("order-modal"),x=Object(c["resolveComponent"])("del-order-modal");return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],null,[Object(c["createVNode"])(v,{active:k.isLoading,"z-index":1060},null,8,["active"]),Object(c["createElementVNode"])("div",n,[l,Object(c["createElementVNode"])("div",r,[Object(c["createElementVNode"])("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=function(){return y.removeAllOrders&&y.removeAllOrders.apply(y,arguments)}),disabled:0===k.orderData.length}," 刪除全部訂單 ",8,o)]),Object(c["createElementVNode"])("table",d,[i,Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(k.orderData,(function(t){return Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],{key:t.id},[k.orderData.length?(Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:0,class:Object(c["normalizeClass"])({"text-secondary":!t.is_paid})},[Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(y.getDate(t.create_at)),1),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("span",null,Object(c["toDisplayString"])(t.user.email),1)]),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("table",s,[Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(t.products,(function(e,t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:t},[Object(c["createElementVNode"])("td",b,Object(c["toDisplayString"])(e.product.title),1),Object(c["createElementVNode"])("td",p,"數量 "+Object(c["toDisplayString"])(e.qty)+" "+Object(c["toDisplayString"])(e.product.unit),1)])})),128))])])]),Object(c["createElementVNode"])("td",m,Object(c["toDisplayString"])(e.$filters.currency(t.total)),1),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("div",u,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"form-check-input",type:"checkbox",id:"".concat(t.id),"onUpdate:modelValue":function(e){return t.is_paid=e},onChange:function(e){return y.updateOrder(t)}},null,40,O),[[c["vModelCheckbox"],t.is_paid]]),Object(c["createElementVNode"])("label",{class:"form-check-label",for:"".concat(t.id)},[t.is_paid?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",h,"已付款")):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",E,"未付款"))],8,j)])]),Object(c["createElementVNode"])("td",null,[Object(c["createElementVNode"])("div",g,[Object(c["createElementVNode"])("button",{class:"btn btn-outline-primary btn-sm",type:"button",onClick:function(e){return y.openOrderModal(t)}}," 檢視 ",8,N),Object(c["createElementVNode"])("button",{class:"btn btn-outline-danger btn-sm",type:"button",onClick:function(e){return y.openDelModal(t)}}," 刪除 ",8,V)])])],2)):Object(c["createCommentVNode"])("",!0)],64)})),128))])]),Object(c["createVNode"])(D,{pages:k.pagination,onEmitPages:y.getOrder},null,8,["pages","onEmitPages"])]),Object(c["createVNode"])(B,{ref:"orderModal",order:k.tempOrder,onUpdatePaid:y.getOrder},null,8,["order","onUpdatePaid"]),Object(c["createVNode"])(x,{ref:"delOrder","temp-order":k.tempOrder,onUpdate:y.getOrder},null,8,["temp-order","onUpdate"])],64)}var k=a("5530"),y=(a("99af"),a("7f36")),v={id:"delOrder",ref:"delOrder",class:"modal fade",tabindex:"-1","aria-labelledby":"delOrderLabel","aria-hidden":"true"},D={class:"modal-dialog"},B={class:"modal-content border-0"},x=Object(c["createElementVNode"])("div",{class:"modal-header bg-danger text-white"},[Object(c["createElementVNode"])("h5",{id:"delOrderLabel",class:"modal-title"},[Object(c["createElementVNode"])("span",null,"刪除訂單")]),Object(c["createElementVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),C={class:"modal-body"},S=Object(c["createTextVNode"])(" 是否刪除 "),_={class:"text-danger"},w=Object(c["createTextVNode"])(" 訂單(刪除後將無法恢復)。 "),M={class:"modal-footer"},L=Object(c["createElementVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function $(e,t,a,n,l,r){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",v,[Object(c["createElementVNode"])("div",D,[Object(c["createElementVNode"])("div",B,[x,Object(c["createElementVNode"])("div",C,[S,Object(c["createElementVNode"])("strong",_,Object(c["toDisplayString"])(a.tempOrder.id),1),w]),Object(c["createElementVNode"])("div",M,[L,Object(c["createElementVNode"])("button",{type:"button",class:"btn btn-danger","data-bs-dismiss":"modal",onClick:t[0]||(t[0]=function(){return r.delOrder&&r.delOrder.apply(r,arguments)})}," 確認刪除 ")])])])],512)}var F=a("7c2b"),P=a.n(F),U={props:["tempOrder"],data:function(){return{modal:""}},mounted:function(){this.modal=new P.a(this.$refs.delOrder,{keyboard:!1,backdrop:"static"})},methods:{delOrder:function(){var e=this,t="".concat("https://vue3-course-api.hexschool.io/v2/","api/").concat("popeye","/admin/order/").concat(this.tempOrder.id);this.$http.delete(t).then((function(t){console.log(t),e.$emit("update"),e.hideModal(),alert("訂單已刪除")})).catch((function(e){console.dir(e),alert(e)}))},openModal:function(){this.modal.show()},hideModal:function(){this.modal.hide()}}},A=a("6b0d"),J=a.n(A);const z=J()(U,[["render",$]]);var T=z,q=(a("b0c0"),{class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"orderModal"}),I={class:"modal-dialog modal-xl",role:"document"},X={class:"modal-content border-0"},G=Object(c["createElementVNode"])("div",{class:"modal-header bg-dark text-white"},[Object(c["createElementVNode"])("h5",{class:"modal-title",id:"exampleModalLabel"},[Object(c["createElementVNode"])("span",null,"訂單細節")]),Object(c["createElementVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),H={class:"modal-body"},K={class:"row"},Q={class:"col-md-4"},R=Object(c["createElementVNode"])("h3",null,"用戶資料",-1),W={class:"table"},Y={key:0},Z=Object(c["createElementVNode"])("th",{style:{width:"100px"}},"姓名",-1),ee=Object(c["createElementVNode"])("th",null,"Email",-1),te=Object(c["createElementVNode"])("th",null,"電話",-1),ae=Object(c["createElementVNode"])("th",null,"地址",-1),ce={class:"col-md-8"},ne=Object(c["createElementVNode"])("h3",null,"訂單細節",-1),le={class:"table"},re=Object(c["createElementVNode"])("th",{style:{width:"100px"}},"訂單編號",-1),oe=Object(c["createElementVNode"])("th",null,"下單時間",-1),de=Object(c["createElementVNode"])("th",null,"付款時間",-1),ie={key:0},se={key:1},be=Object(c["createElementVNode"])("th",null,"付款狀態",-1),pe={key:0,class:"text-success"},me={key:1,class:"text-muted"},ue=Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"總金額"),Object(c["createElementVNode"])("td")],-1),Oe=Object(c["createElementVNode"])("h3",null,"選購商品",-1),je={class:"table"},he=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr")],-1),Ee=Object(c["createElementVNode"])("td",{class:"text-end"},null,-1),ge={class:"d-flex justify-content-end"},Ne={class:"form-check"},Ve={class:"form-check-label",for:"flexCheckDefault"},fe={key:0},ke={key:1},ye={class:"modal-footer"},ve=Object(c["createElementVNode"])("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function De(e,t,a,n,l,r){return Object(c["openBlock"])(),Object(c["createElementBlock"])("div",q,[Object(c["createElementVNode"])("div",I,[Object(c["createElementVNode"])("div",X,[G,Object(c["createElementVNode"])("div",H,[Object(c["createElementVNode"])("div",K,[Object(c["createElementVNode"])("div",Q,[R,Object(c["createElementVNode"])("table",W,[l.tempOrder.user?(Object(c["openBlock"])(),Object(c["createElementBlock"])("tbody",Y,[Object(c["createElementVNode"])("tr",null,[Z,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(l.tempOrder.user.name),1)]),Object(c["createElementVNode"])("tr",null,[ee,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(l.tempOrder.user.email),1)]),Object(c["createElementVNode"])("tr",null,[te,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(l.tempOrder.user.tel),1)]),Object(c["createElementVNode"])("tr",null,[ae,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(l.tempOrder.user.address),1)])])):Object(c["createCommentVNode"])("",!0)])]),Object(c["createElementVNode"])("div",ce,[ne,Object(c["createElementVNode"])("table",le,[Object(c["createElementVNode"])("tbody",null,[Object(c["createElementVNode"])("tr",null,[re,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(l.tempOrder.id),1)]),Object(c["createElementVNode"])("tr",null,[oe,Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(r.getDate(l.tempOrder.create_at)),1)]),Object(c["createElementVNode"])("tr",null,[de,Object(c["createElementVNode"])("td",null,[l.tempOrder.is_paid?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",ie,Object(c["toDisplayString"])(r.paidOrder(l.tempOrder)),1)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",se,"尚未付款"))])]),Object(c["createElementVNode"])("tr",null,[be,Object(c["createElementVNode"])("td",null,[l.tempOrder.is_paid?(Object(c["openBlock"])(),Object(c["createElementBlock"])("strong",pe,"已付款")):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",me,"尚未付款"))])]),ue])]),Oe,Object(c["createElementVNode"])("table",je,[he,Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(l.tempOrder.products,(function(e){return Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:e.id},[Object(c["createElementVNode"])("th",null,Object(c["toDisplayString"])(e.product.title),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.qty)+" / "+Object(c["toDisplayString"])(e.product.unit),1),Ee])})),128))])]),Object(c["createElementVNode"])("div",ge,[Object(c["createElementVNode"])("div",Ne,[Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":t[0]||(t[0]=function(e){return l.tempOrder.is_paid=e}),onClick:t[1]||(t[1]=function(e){return r.paidOrder(l.tempOrder)})},null,512),[[c["vModelCheckbox"],l.tempOrder.is_paid]]),Object(c["createElementVNode"])("label",Ve,[l.tempOrder.is_paid?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",fe,"已付款")):(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",ke,"未付款"))])])])])])]),Object(c["createElementVNode"])("div",ye,[ve,Object(c["createElementVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[2]||(t[2]=function(e){return r.updateOrder(l.tempOrder)})}," 修改付款狀態 ")])])])],512)}a("e9c4");var Be={props:{order:{type:Object,default:function(){return{}}}},data:function(){return{status:{},modal:"",tempOrder:{},isPaid:!1,paid:{}}},emits:["update-paid"],mounted:function(){this.modal=new P.a(this.$refs.orderModal,{keyboard:!1,backdrop:"static"})},watch:{order:function(){this.tempOrder=JSON.parse(JSON.stringify(this.order))}},methods:{paidOrder:function(e){if(this.paid={is_paid:e.is_paid},!0===this.paid.is_paid)return this.paid.paid_day=Date.now(),this.paid.paid_day=new Date(this.paid.paid_day),this.paid.paid_day.toLocaleDateString();this.paid.paid_day=""},updateOrder:function(e){var t=this,a="".concat("https://vue3-course-api.hexschool.io/v2/","api/").concat("popeye","/admin/order/").concat(e.id);this.$http.put(a,{data:this.paid}).then((function(e){t.$emit("update-paid"),t.modal.hide(),alert(e.data.message)})).catch((function(e){alert(e)}))},getDate:function(e){var t=new Date(1e3*e);return t.toLocaleDateString()},openModal:function(){this.modal.show()},hideModal:function(){this.modal.hide()}}};const xe=J()(Be,[["render",De]]);var Ce=xe,Se={data:function(){return{orderData:{},pagination:{},isLoading:!1,tempOrder:{},page:1}},components:{pagination:y["a"],DelOrderModal:T,OrderModal:Ce},methods:{getOrder:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.page=t;var a="".concat("https://vue3-course-api.hexschool.io/v2/","api/").concat("popeye","/admin/orders?page=").concat(t);this.isLoading=!0,this.$http.get(a).then((function(t){console.log(t),e.orderData=t.data.orders,e.pagination=t.data.pagination,console.log(e.orderData),e.isLoading=!1})).catch((function(e){alert(e.data.message)}))},getDate:function(e){var t=new Date(1e3*e);return t.toLocaleDateString()},updateOrder:function(e){var t=this;this.isLoading=!0;var a="".concat("https://vue3-course-api.hexschool.io/v2/","api/").concat("popeye","/admin/order/").concat(e.id),c={is_paid:e.is_paid};!0===!c.is_paid?c.paid_day=Date.now():c.paid_day="",this.$http.put(a,{data:c}).then((function(e){console.log(e),t.getOrder(t.page),alert("訂單已更新"),t.isLoading=!1})).catch((function(e){alert(e)}))},openOrderModal:function(e){this.tempOrder=Object(k["a"])({},e),this.$refs.orderModal.openModal()},openDelModal:function(e){this.tempOrder=Object(k["a"])({},e),this.$refs.delOrder.openModal()},removeAllOrders:function(){var e=this;this.isLoading=!0;var t="".concat("https://vue3-course-api.hexschool.io/v2/","api/").concat("popeye","/admin/orders/all");this.$http.delete(t).then((function(t){e.getOrder(e.page),alert("訂單已全部刪除"),e.isLoading=!1})).catch((function(e){alert(e)}))}},mounted:function(){this.getOrder()}};const _e=J()(Se,[["render",f]]);t["default"]=_e},b0c0:function(e,t,a){var c=a("83ab"),n=a("5e77").EXISTS,l=a("e330"),r=a("9bf2").f,o=Function.prototype,d=l(o.toString),i=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,s=l(i.exec),b="name";c&&!n&&r(o,b,{configurable:!0,get:function(){try{return s(i,d(this))[1]}catch(e){return""}}})},e9c4:function(e,t,a){var c=a("23e7"),n=a("da84"),l=a("d066"),r=a("2ba4"),o=a("e330"),d=a("d039"),i=n.Array,s=l("JSON","stringify"),b=o(/./.exec),p=o("".charAt),m=o("".charCodeAt),u=o("".replace),O=o(1..toString),j=/[\uD800-\uDFFF]/g,h=/^[\uD800-\uDBFF]$/,E=/^[\uDC00-\uDFFF]$/,g=function(e,t,a){var c=p(a,t-1),n=p(a,t+1);return b(h,e)&&!b(E,n)||b(E,e)&&!b(h,c)?"\\u"+O(m(e,0),16):e},N=d((function(){return'"\\udf06\\ud834"'!==s("\udf06\ud834")||'"\\udead"'!==s("\udead")}));s&&c({target:"JSON",stat:!0,forced:N},{stringify:function(e,t,a){for(var c=0,n=arguments.length,l=i(n);c<n;c++)l[c]=arguments[c];var o=r(s,null,l);return"string"==typeof o?u(o,j,g):o}})}}]);
//# sourceMappingURL=chunk-a7b7a38a.af72a73f.js.map